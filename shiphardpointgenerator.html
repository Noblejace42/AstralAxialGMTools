<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ship Hardpoint Generator</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<nav>
  <a href="index.html">System Generator</a> |
  <a href="lifepath.html">Lifepath Generator</a> |
  <a href="weapongenerator.html">Weapon Generator</a> |
  <a href="combat_tracker.html">Combat Tracker</a> |
  <a href="abilitytree.html">Abilities</a> |
  <a href="shiphardpointgenerator.html">Shipyard</a>
</nav>
<body>
  <div class="container">
    <h1>Ship Hardpoint Generator</h1>

    <div class="section">
      <button onclick="generateStore()">Generate Ship Parts Store</button>
    </div>

    <div class="section">
      <div><strong>Shipyard Name:</strong> <span id="shipyardName"></span></div>
      <div><strong>Store Owner:</strong> <span id="storeOwner"></span></div>
      <div><strong>Store Name:</strong> <span id="storeName"></span></div>
    </div>

    <div class="section">
      <label for="partCount">Number of Ship Parts:</label>
      <select id="partCount">
        <option value="1">1</option>
        <option value="5">5</option>
        <option value="10">10</option>
        <option value="20">20</option>
      </select>
      <button onclick="generateParts()">Generate Parts</button>
    </div>

    <div class="section">
      <h2>Generated Ship Parts</h2>
      <div id="partsOutput"></div>
    </div>
  </div>

  <script>
    // Helper functions
    function weightedRandom(choices) {
      let totalWeight = choices.reduce((sum, choice) => sum + choice.weight, 0);
      let randomNum = Math.random() * totalWeight;
      for (let i = 0; i < choices.length; i++) {
        if (randomNum < choices[i].weight) {
          return choices[i].value !== undefined ? choices[i].value : choices[i];
        }
        randomNum -= choices[i].weight;
      }
    }

    function randomInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    // Generates a random integer from 1-10 with weight = (11 - value)
    function weightedRandomX() {
      let choices = [];
      for (let i = 1; i <= 10; i++) {
        choices.push({ value: i, weight: 11 - i });
      }
      return weightedRandom(choices);
    }

    // Dice generation (4,6,8,10,12 with weighted probabilities)
    function generateDice() {
      let diceOptions = [
        { value: 4, weight: 40 },
        { value: 6, weight: 30 },
        { value: 8, weight: 20 },
        { value: 10, weight: 8 },
        { value: 12, weight: 2 }
      ];
      return weightedRandom(diceOptions);
    }

    // Part type generation with weighted probabilities: Weapons are far more likely.
    function generatePartType() {
      let partTypeChoices = [
        { value: "Weapon", weight: 50 },
        { value: "Thruster", weight: 20 },
        { value: "Reactor", weight: 15 },
        { value: "UtilityModule", weight: 7.5 },
        { value: "AdvancedModule", weight: 7.5 }
      ];
      return weightedRandom(partTypeChoices);
    }

    // Shipyard name generator arrays (modeled after settlement names)
    const shipyardPrefixes = ["Cor", "Ald", "Nab", "Tar", "Ven", "Lor", "Ryl", "Mar", "Dorn", "Kess", "Zen", "Lux", "Nov", "Xen", "Sol", "Neb"];
    const shipyardCores = ["anta", "osis", "ar", "osa", "ion", "oran", "eros", "exis", "ur", "xel"];
    const shipyardSuffixes = ["Prime", "Major", "Station", "Hold", "Citadel", "Outpost", "Bastion", "Spire"];

    function generateShipyardName() {
      let prefix = shipyardPrefixes[randomInt(0, shipyardPrefixes.length - 1)];
      let core = shipyardCores[randomInt(0, shipyardCores.length - 1)];
      let suffix = shipyardSuffixes[randomInt(0, shipyardSuffixes.length - 1)];
      return prefix + core + " " + suffix;
    }

    // Store owner name generator (using similar arrays as in the provided JSON)
    const ownerFirstNamePrefixes = ["Xan", "Tal", "Ver", "Mar", "Sel", "Neo", "Sky", "Cy", "Zor", "Lex"];
    const ownerFirstNameSuffixes = ["dor", "en", "ix", "ar", "on", "us"];
    const ownerLastNamePrefixes = ["Xan", "Tal", "Ver", "Mar", "Sel", "Neo", "Sky", "Cy", "Zor", "Lex"];
    const ownerLastNameSuffixes = ["dor", "en", "ix", "ar", "on", "us"];

    function generateStoreOwnerName() {
      let first = ownerFirstNamePrefixes[randomInt(0, ownerFirstNamePrefixes.length - 1)] +
                  ownerFirstNameSuffixes[randomInt(0, ownerFirstNameSuffixes.length - 1)];
      let last = ownerLastNamePrefixes[randomInt(0, ownerLastNamePrefixes.length - 1)] +
                 ownerLastNameSuffixes[randomInt(0, ownerLastNameSuffixes.length - 1)];
      return "Captain " + first + " " + last;
    }

    // Store name generator (for example purposes)
    function generateStoreName() {
      let adjectives = ["Galactic", "Stellar", "Cosmic", "Interstellar", "Orbital"];
      let nouns = ["Emporium", "Depot", "Outpost", "Exchange", "Bazaar"];
      return adjectives[randomInt(0, adjectives.length - 1)] + " " + nouns[randomInt(0, nouns.length - 1)];
    }

    // Ship part generators
    function generateWeaponPart() {
      let weight = weightedRandomX();
      let dice = generateDice();
      // Exactly one required tag from the list
      let requiredTags = ["Technical", "Targeting", "Recoiling"];
      let reqTag = requiredTags[randomInt(0, requiredTags.length - 1)];
      // Generate more optional tags for weapons (between 2 and 5 tags)
      let optionalTags = [
        "Mounted",
        "Emplacement",
        "Swiveling " + weightedRandomX(),
        "Stealthy",
        "Heat seeking",
        "Chasing",
        "Charging " + weightedRandomX(),
        "Overheating",
        "Ammo",
        "Reloading",
        "Complicated " + weightedRandomX(),
        "EMP"
      ];
      let numOptional = randomInt(2, 5);
      let selectedOptional = [];
      for (let i = 0; i < numOptional; i++) {
        let tag = optionalTags[randomInt(0, optionalTags.length - 1)];
        if (!selectedOptional.includes(tag)) {
          selectedOptional.push(tag);
        }
      }
      return "Weapon|" + weight + " (1d" + dice + ", " + reqTag + ", " + selectedOptional.join(", ") + ")";
    }

    // For non-weapon parts, remove tag generation.
    function generateThrusterPart() {
      let weight = weightedRandomX();
      let dice = generateDice();
      return "Thruster|" + weight + " (1d" + dice + ")";
    }

    function generateReactorPart() {
      let weight = weightedRandomX();
      let powerIncrease = generateDice();
      return "Reactor|" + weight + " (" + powerIncrease + ")";
    }

    function generateUtilityModule() {
      let weight = weightedRandomX();
      return "Utility Module Name [" + weight + "]";
    }

    function generateAdvancedModule() {
      let weight = weightedRandomX();
      return "Advanced Module Name [" + weight + "]";
    }

    // Generate parts and sort by type
    function generateParts() {
      let count = parseInt(document.getElementById("partCount").value);
      let parts = [];
      
      for (let i = 0; i < count; i++) {
        let type = generatePartType();
        let part;
        if (type === "Weapon") {
          part = generateWeaponPart();
        } else if (type === "Thruster") {
          part = generateThrusterPart();
        } else if (type === "Reactor") {
          part = generateReactorPart();
        } else if (type === "UtilityModule") {
          part = generateUtilityModule();
        } else if (type === "AdvancedModule") {
          part = generateAdvancedModule();
        }
        parts.push({ type: type, description: part });
      }
      
      // Sort parts alphabetically by type
      parts.sort((a, b) => a.type.localeCompare(b.type));
      
      let output = "";
      let currentType = "";
      parts.forEach(p => {
        if (p.type !== currentType) {
          currentType = p.type;
          output += "<h3>" + currentType + "</h3>";
        }
        output += "<div class='part-item'>" + p.description + "</div>";
      });
      document.getElementById("partsOutput").innerHTML = output;
    }

    function generateStore() {
      let shipyardName = generateShipyardName();
      let storeOwner = generateStoreOwnerName();
      let storeName = generateStoreName();
      document.getElementById("shipyardName").textContent = shipyardName;
      document.getElementById("storeOwner").textContent = storeOwner;
      document.getElementById("storeName").textContent = storeName;
    }
  </script>
</body>
</html>
